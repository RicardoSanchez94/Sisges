@model  List<SistemaGestion.Models.Sencillos>
<div class="container shadow-lg p-3 mb-5 mt-5 bg-body rounded">
    <div class="row">
        <div class="col-lg-12">
            <div class="row">
                <div class="col-lg-12">
                    <div class="table-responsive">
                        <table id="Sencillos" class="table table-bordered table-hover" cellspacing="0" width="100%">
                            <thead>
                                <tr>
                                    @*<th class="text-center">Id</th>*@
                                    <th class="text-center">Fecha de Carga</th>
                                    <th class="text-center">Fecha Periodo Inicio</th>
                                    <th class="text-center">Fecha Periodo FIN</th>
                                    <th class="text-center">Accion</th>

                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var a in Model)
                                {
                                    <tr>
                                        @*<td class="text-center">@a.Id</td>*@
                                        <td class="text-center">@a.Fecha</td>
                                        <td class="text-center">@a.FechaInicio</td>
                                        <td class="text-center">@a.FechaFin</td>
                                        <td class="text-center">
                                            <button type='button' class='editar btn btn-outline-info btn-sm shadow-sm' title="Detalle"
                                                    onclick="DetalleBySencillo('@a.Id')">
                                                <span class='fa fa-list-alt'></span>
                                            </button>
                                            <button type='button' class='editar btn btn-outline-danger btn-sm shadow-sm' title="Eliminar"
                                                    onclick="Eliminar('@a.Id')">
                                                <span class='fa fa-trash'></span>
                                            </button>
                                            @*<button type='button' class='editar btn btn-outline-danger btn-sm shadow-sm' title="PDF"
        onclick="PDF('@a.Id')">
                <span class='fa fa-file-pdf'></span>
               </button>*@
                                        </td>

                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div>
    </div>

</div>
<div class="modal fade" id="ModalDetalle" role="dialog">
</div>

<script>
    $(document).ready(function () {
        $('#Sencillos').DataTable({
            responsive: true,
             "language": {
                   url: "@Url.Content("~/Content/datatable/js/datatable_spanish.json")"
               }
        });



    });
    function DetalleBySencillo(Id) {
            console.log('entro aca');
            console.log(Id)
        //var data = { fecha: fecha, idCencos: cencos, idZona: zona, nomCenco: nomCencos};
         var url = "@Url.Action("DetailsSencillo", "Tesoreria")";
            $.ajax({
                type: 'POST',
                url: url,
                data: { Id: Id },
            success: function (response) {
                $("#ModalDetalle").html(response);
                $("#ModalDetalle").modal('show');
            },
            error: function (xhr, ajaxOptions, thrownError) {
                alert(thrownError);
            }
        });
    }

    function Eliminar(Id) {
            console.log('entro aca');
            console.log(Id)
        //var data = { fecha: fecha, idCencos: cencos, idZona: zona, nomCenco: nomCencos};
        $('#cargal').modal('show');
         var url = "@Url.Action("EliminarCarta", "Tesoreria")";
            $.ajax({
                type: 'POST',
                url: url,
                data: { Id: Id },
                success: function (response) {
                    if (response == false) {
                        setTimeout(carga, 3000);
                /* setTimeout(CerrarVistaP, 10000);*/
                setTimeout(mostrarMensaje, 4000);
                        setTimeout(bajaModal, 6000);
                        console.log("entro eliminar")
                function carga() {

                    $("#cargal").modal('hide');

                };

                function bajaModal() {
                    $('#cargarMensajes').modal('hide');
                    $('#modal').modal('hide');


                };

                function mostrarMensaje() {
                    $("#cargarMensajes").modal('show');
                    $('#mensajeLoad').html(response.respuesta);

                };
                    }
                    else {
                        setTimeout(carga, 3000);
                        setTimeout(mostrarMensaje, 4000);
                        setTimeout(bajaModal, 6000);

                        function carga() {
                            $("#cargal").modal('hide');
                            //$("#cargarMensajes").modal('show');
                            //$('#mensajeLoad').html(r.respuesta);
                        };
                        function bajaModal() {

                            $("#cargarMensajes").modal('hide');

                        };

                        function mostrarMensaje() {
                            bajarModalDiferencias();
                            $("#cargarMensajes").modal('show');
                            $('#mensajeLoad').html(response.respuesta);

                        };

                    }

            },
            error: function (xhr, ajaxOptions, thrownError) {
                alert(thrownError);
            }
        });
    }

                function bajarModalDiferencias() {
                 console.log("Entrea bajar el modal");
                     var Inicio = $("#Inicio").val();
                        var Fin = $("#Fin").val();
                        if (Inicio == Fin || Fin == Inicio ) {
                            alert("Las Fechas no pueden ser Iguales")
                            return 0;
                        }
                        if (Fin < Inicio) {
                            alert("Las Fecha de Fin no puede ser menor que la Fecha de Inicio")
                            return 0;
                        }
                        $('#cargal').modal('show');
                        var url = "@Url.Action("Index", "Tesoreria")";
                        var manejarErrorAjax = "Eror";

                        var data = { Inicio: Inicio, Fin: Fin};
                        $.post(url, data).done(function (data) {
                            setTimeout(bajar, 1000);
                            setTimeout(Subir, 2000);

                            function bajar() {
                                $('#cargal').modal('hide');

                            }
                            function Subir() {
                                $('#diferencias').html(data);
                                $('#diferencias').show();
                            }

                        }).fail(manejarErrorAjax);

        }

</script>
