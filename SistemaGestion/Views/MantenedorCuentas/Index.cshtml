@model  List<SistemaGestion.Models.Cuenta>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<body class="sb-nav-fixed">
    <div id="layoutSidenav">
        <div id="layoutSidenav_content">
            <main>
                <div class="container-fluid px-4">
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item active" aria-current="page">Transacciones</li>
                            <li class="breadcrumb-item"><a href="@Url.Action("TransaccionesTotales", "ApiTransbank")">Totales</a></li>

                        </ol>
                    </nav>

                    <div class="row">
                        <div class="col-sm-12">
                            <div class="card border-secondary">
                                <div class="card-header bg-secondary text-white">
                                    Mantenedor Cuentas Contables
                                </div>
                            
                                <div class="container shadow-lg p-3 mb-5 mt-5 bg-body rounded">

                                    @*<button type='button' class='btn btn-primary fa-align-right' onclick='Nuevo()'><span class='fa fa-newspaper'></span> Nuevo</button>*@
                                    <div class="row">

                                        <div class="col">

                                            <table id="tablaVacia" class="table table-bordered  display nowrap" cellspacing="0" width="100%">
                                                <thead>
                                                    <tr>
                                                        <th class="text-center">Numero de Cuenta</th>
                                                        <th class="text-center">Descripcion</th>
                                                        <th class="text-center">Estado</th>
                                                        <th class="text-center">#</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @foreach (var item in Model)
                                                    {
                                                        <tr>
                                                            <td>@item.NumeroCuenta</td>
                                                            <td>@item.Descripcion</td>
                                                            @{

                                                                if (@item.Estado == false)
                                                                {
                                                                    <td class="bg-danger text-white">Desabilitado</td>
                                                                }
                                                                else
                                                                {
                                                                    <td class="bg-success text-white">Habilitado</td>
                                                                }

                                                            }
                                                            <td> <button type='button' class='editar btn btn-danger' onclick='Editar("@item.Codigo")'><span class='fa fa-edit'></span></button></td>


                                                        </tr>
                                                    }
                                                </tbody>

                                            </table>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>


                </div>
            </main>
        </div>
    </div>
</body>

<!-- Modal -->
<div class="modal fade" id="VistaParcialEdit" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="staticBackdropLabel" aria-hidden="true">
</div>
<div class="modal fade" id="VistaParcialNuevo" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="staticBackdropLabel" aria-hidden="true">
</div>
@section scripts{
    <script>
    $(document).ready(function () {
        $('#tablaVacia').DataTable(
            {
                responsive: true,
                dom: 'Bftip',
                buttons: [{
                    text: 'Nueva Cuenta +',
                    attr: { class: 'btn btn-primary' },
                    action: function (e, dt, node, config) {
                        Nuevo()
                    }

                }],
                "language": {
                    url: "@Url.Content("~/Content/datatable/js/datatable_spanish.json")"
                }
            });
    });

      function Editar(Codigo) {
        //  var local = Local;
          console.log('Editar');
        //console.log(Descripcion);
        //console.log(Estado);
         var url = '@Url.Action("Edit", "MantenedorCuentas")';
           $.ajax({
            type: 'GET',
               url: url,
               data: { Codigo:Codigo },
               success: function (response) {
                   $("#VistaParcialEdit").html(response);
                   $("#VistaParcialEdit").modal('show');


               },
               error: function (xhr, ajaxOptions, thrownError) {
                   alert(thrownError);
               }
             });
        };

         function Nuevo() {
         var url = '@Url.Action("NewCuentaContables", "MantenedorCuentas")';
           $.ajax({
            type: 'GET',
               url: url,
               success: function (response) {
                   $("#VistaParcialNuevo").html(response);
                   $("#VistaParcialNuevo").modal('show');


               },
               error: function (xhr, ajaxOptions, thrownError) {
                   alert(thrownError);
               }
             });
        };


        function bajarModalEdit() {
            $('#VistaParcialEdit').modal('hide');
        }
    </script>
}



