@model  SistemaGestion.Models.Sencillos_Tiendas

<div class="modal-dialog" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Insertar El Remito Devolucion</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <div class="row">
                @using (Html.BeginForm("Recepcion", "Tienda", FormMethod.Post, new { id = "InsertRemito", role = "form", enctype = "multipart/form-data" }))
                {
                <div class="col-sm-12">

                    @Html.HiddenFor(x => x.id)
                    @Html.HiddenFor(x => x.idTienda)

                    @*@Html.HiddenFor(x => x.)
        @Html.HiddenFor(x => x.Local)*@

                    @*<input type="hidden" id="txtIdPersona" />*@
                    <div class="form-group">
                        <label for="txtNombre">N° Remito Devolucion:</label>
                        <input type="text" class="form-control form-control-sm model" id="Remito" name="Remito" autocomplete="off">
                    </div>
                    <div class="form-group">
                        <label for="txtNombre"> N° Deposito:</label>
                        <input type="text" class="form-control form-control-sm model" id="Deposito" name="Deposito" autocomplete="off">
                    </div>


                </div>

                }
            </div>



        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
            <button type="submit" class="btn btn-primary" id="btcarga">Ingresar</button>
        </div>
    </div>
</div>
<script>
     $(function () {
         $("#btcarga").click(function () {
                event.preventDefault();
                var result = confirm("Desea devolver el Sencillo?");
                if (result) {
                    $('#cargal').modal('show');
                    var url = "@Url.Action("RemitoDevolucion", "Tienda")";
                    var manejarErrorAjax = "Eror";
                 /*   var parametros = $("#AgregarConciliacionManual").serialize();*/
                    var CodigoRemito = $("#Remito").val();
                    var Tienda = $("#idTienda").val();
                    var idSencillosTienda = $("#id").val();
                    var Deposito = $("#Deposito").val();
                    var parametros = { CodigoRemito: CodigoRemito, Tienda: Tienda, idSencillosTienda: idSencillosTienda, Deposito: Deposito };
                    console.log(parametros);
                    $.post(url, parametros).done(function (res) {
                        if (res.error == false) {

                            setTimeout(carga, 3000);
                            setTimeout(mostrarMensaje, 4000);
                            setTimeout(bajaModal, 6000);
                            BajarModalInserDevolucion();
                            MostrarLista();

                            //setTimeout(bajarModalConciliacion, 8000);
                            function carga() {
                                $("#cargal").modal('hide');
                                //$("#cargarMensajes").modal('show');
                                //$('#mensajeLoad').html(r.respuesta);
                            };
                            function bajaModal() {

                                $("#cargarMensajes").modal('hide');
                                $("#totales").modal('hide');
                                location.reload();

                            };

                            function mostrarMensaje() {
                                $("#cargarMensajes").modal('show');
                                $('#mensajeLoad').html(res.respuesta);

                            };

                        /*    function Cargar*/


                        } else {

                            setTimeout(carga, 3000);
                            setTimeout(bajaModal, 4000);
                            setTimeout(mostrarMensaje, 8000);
                        


                            function carga() {
                                $("#cargal").modal('hide');
                                //$("#cargarMensajes").modal('show');
                                //$('#mensajeLoad').html(r.respuesta);
                            };
                            function bajaModal() {

                                $("#cargarMensajes").modal('hide');

                            };

                            function mostrarMensaje() {
                                $("#cargarMensajes").modal('show');
                                $('#mensajeLoad').html(res.respuesta);

                            };

                        }
                        //$('.modal-backdrop').remove();

                    }).fail(manejarErrorAjax);

                }
            });

     })

    function MostrarLista() {
        $('#cargal').modal('show');
        var url = "@Url.Action("Sencillo", "Tienda")";
        var manejarErrorAjax = "Eror";
        $.get(url).done(function (data) {
            setTimeout(bajar, 1000);
            /*setTimeout(Subir, 2000);*/

            function bajar() {
                $('#cargal').modal('hide');

            }
            //function Subir() {
            //    $('#totales').html(data);
            //    $('#totales').show();
            //}

        }).fail(manejarErrorAjax);

    }
</script>

